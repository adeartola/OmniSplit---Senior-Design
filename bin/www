#!/usr/bin/env node
var debug = require('debug')('orderly-comms');
var fs    = require('fs');
var app   = require('../app');
var https = require('https');
var http  = require('http');

var options = {
    key: fs.readFileSync(__dirname + '/../certs/orderly.key'),
    cert: fs.readFileSync(__dirname + '/../certs/orderly.crt')
};

var secureServer = https.createServer(options, app);
var unsecureServer = http.createServer(app);

var io = require('socket.io')(secureServer);

var chat = require('../models/chat')(io);

secureServer.listen(443, function() {
  debug('Secure express server listening on port ' + secureServer.address().port);
});

unsecureServer.listen(80, function() {
  debug('Secure express server listening on port ' + secureServer.address().port);
});
